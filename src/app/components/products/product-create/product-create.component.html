<div class="product-create-container">
  <h2>Create Product</h2>

  <form [formGroup]="productForm" (ngSubmit)="onSubmit()">
    <div class="form-grid">
      <!-- Product Name -->
      <div>
        <label for="name">Product Name</label>
        <input id="name" formControlName="name" type="text" />
        <div *ngIf="f.name.touched && f.name.invalid">
          <small class="text-danger"
            >Product name is required (min 3 characters).</small
          >
        </div>
      </div>

      <!-- Stock -->
      <div>
        <label for="stock">Stock</label>
        <input id="stock" formControlName="stock" type="number" />
        <div *ngIf="f.stock.touched && f.stock.invalid">
          <small class="text-danger">Stock is required.</small>
        </div>
      </div>

      <!-- Category -->
      <div>
        <label for="category">Category</label>
        <input id="category" formControlName="category" type="text" />
        <div *ngIf="f.category.touched && f.category.invalid">
          <small class="text-danger">Category is required.</small>
        </div>
      </div>

      <!-- Description -->
      <div style="grid-row: 2 / span 2; grid-column: 2; width: 100%">
        <label for="description">Description</label>
        <textarea
          id="description"
          formControlName="description"
          rows="5"
        ></textarea>
        <div *ngIf="f.description.touched && f.description.invalid">
          <small class="text-danger">Description is required.</small>
        </div>
      </div>

      <!-- Amount -->
      <div>
        <label for="amount">Amount</label>
        <input id="amount" formControlName="amount" type="number" />
        <div *ngIf="f.amount.touched && f.amount.invalid">
          <small class="text-danger">Amount is required.</small>
        </div>
      </div>
    </div>

    <!-- Image Upload -->
    <div>
      <div class="formInput" style="position: relative">
        <label
          style="
            cursor: pointer;
            text-align: center;
            position: absolute;
            top: 0;
            font-size: 18px;
            font-weight: 600;
            border: 1px solid transparent;
            padding: 15px;
            border-radius: 8px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
          "
          >Select Images</label
        >
        <input
          type="file"
          (change)="onMediaChange($event)"
          accept="image/jpeg"
          multiple
          style="
            opacity: 0;
            z-index: 9;
            position: relative;
            width: 200px;
            cursor: pointer;
          "
        />
      </div>
      <div
        *ngIf="mediaArray.length === 0 && submitted"
        style="margin-top: 20px"
      >
        <small class="text-danger">At least one image is required.</small>
      </div>

      <div class="mediaFlex d-grid">
        <div
          *ngFor="let media of mediaArray; let i = index"
          class="mediaGallery"
        >
          <span
            class="material-symbols-outlined"
            (click)="removeMedia(i)"
            style="cursor: pointer"
          >
            close
          </span>
          <img
            [src]="media.image"
            alt="media"
            style="
              aspect-ratio: 1;
              object-fit: cover;
              width: 85%;
              border-radius: 10px;
            "
          />
        </div>
      </div>
    </div>

    <!-- Submit -->
    <button type="submit">Create</button>

    <!-- Global error -->
    <p class="error" *ngIf="errorMessage">{{ errorMessage }}</p>
  </form>
</div>
