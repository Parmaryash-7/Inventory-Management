<div class="product-create-container">
  <h2>Create Product</h2>

  <form #productForm="ngForm" (ngSubmit)="onSubmit()" novalidate>
    <div class="form-grid">
      <!-- Product Name -->
      <div>
        <label for="name">Product Name</label>
        <input
          type="text"
          id="name"
          name="name"
          [(ngModel)]="product.name"
          #name="ngModel"
          required
          minlength="3"
        />
        <div *ngIf="name.invalid && (name.dirty || name.touched)">
          <small class="text-danger"
            >Product name is required (min 3 characters).</small
          >
        </div>
      </div>

      <!-- Stock -->
      <div>
        <label for="stock">Stock</label>
        <input
          type="number"
          id="stock"
          name="stock"
          [(ngModel)]="product.stock"
          #stock="ngModel"
          required
        />
        <div *ngIf="stock.invalid && (stock.dirty || stock.touched)">
          <small class="text-danger">Stock is required.</small>
        </div>
      </div>

      <!-- Category -->
      <div>
        <label for="category">Category</label>
        <input
          type="text"
          id="category"
          name="category"
          [(ngModel)]="product.category"
          #category="ngModel"
          required
        />
        <div *ngIf="category.invalid && (category.dirty || category.touched)">
          <small class="text-danger">Category is required.</small>
        </div>
      </div>

      <!-- Description -->
      <div style="grid-row: 2 / span 2; grid-column: 2; width: 100%">
        <label for="description">Description</label>
        <textarea
          id="description"
          name="description"
          [(ngModel)]="product.description"
          #description="ngModel"
          rows="5"
          required
        ></textarea>
        <div
          *ngIf="
            description.invalid && (description.dirty || description.touched)
          "
        >
          <small class="text-danger">Description is required.</small>
        </div>
      </div>

      <!-- Amount -->
      <div>
        <label for="amount">Amount</label>
        <input
          type="number"
          id="amount"
          name="amount"
          [(ngModel)]="product.amount"
          #amount="ngModel"
          required
        />
        <div *ngIf="amount.invalid && (amount.dirty || amount.touched)">
          <small class="text-danger">Amount is required.</small>
        </div>
      </div>
    </div>

    <!-- Image Upload -->
    <div>
      <div class="formInput" style="position: relative">
        <div class="img-hover-container" style="width: fit-content;">
          <label
            class="button img-hover-btn"
            style="
              cursor: pointer;
              text-align: center;
              position: absolute;
              top: 0;
              font-size: 18px;
              font-weight: 600;
              padding: 15px;
              border-radius: 8px;
              color: white;
              width: 200px;
            "
            >Select Images</label
          >
          <input
            type="file"
            name="media"
            #mediaInput
            multiple
            (change)="onMediaChange($event)"
            required
            accept="image/jpeg"
            style="
              opacity: 0;
              z-index: 9;
              position: relative;
              cursor: pointer;
              width: 200px;
              padding: 15px;
            "
          />
        </div>
      </div>
      <div *ngIf="mediaArray.length === 0 && submitted">
        <small class="text-danger">At least one image is required.</small>
      </div>
      <div class="mediaFlex d-grid">
        <div
          *ngFor="let media of mediaArray; let i = index"
          class="mediaGallery"
        >
          <span
            class="material-symbols-outlined"
            (click)="removeMedia(i, media.id)"
            style="cursor: pointer"
          >
            close
          </span>
          <img
            [src]="media.image"
            alt="media"
            style="
              aspect-ratio: 1;
              object-fit: cover;
              width: 85%;
              border-radius: 10px;
            "
          />
        </div>
      </div>
    </div>

    <!-- Submit -->
    <button class="button" type="submit">Create</button>

    <!-- General error message -->
    <!-- <p
      class="text-danger"
      *ngIf="submitted && !productForm.form.valid && mediaArray.length === 0"
    >
      Please fill out this form.
    </p> -->

    <p class="error" *ngIf="errorMessage">{{ errorMessage }}</p>
  </form>
</div>
